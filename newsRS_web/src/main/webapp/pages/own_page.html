<!DOCTYPE html>
<html lang="zh" data-hairline="true" data-focus-visible="">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>个人中心</title>

    <link rel="stylesheet" href="../plugins/bootstrap/css/bootstrap.min.css">
    <script src="../plugins/jQuery/jquery-3.3.1.min.js"></script>
    <script src="../plugins/bootstrap/js/bootstrap.min.js"></script>
    <link href="../css/own_page.css" rel="stylesheet">
    <link href="../css/own_page_routes.css" rel="stylesheet">
    <script src="../plugins/angularjs/angular.min.js"></script>
    <script src="../plugins/angularjs/pagination-search.js"></script>
    <script src="../js/ownPage.js"></script>
    <script src="../js/service/ownPageService.js"></script>
    <script src="../js/controller/ownPageController.js"></script>
    <style>
        #content img {
            display: none;
        }
    </style>

</head>
<body ng-app="newsRS" ng-controller="ownPageController" ng-init="init()" style="line-height: 1.42858;
  font-size: 14px; width: 100%">

<!-- 头部 -->
<div ng-include="'../pages/own_header.html'"></div>
<main class="App-main">
    <div class="ProfileHeader">
        <div class="Card">
            <div class="UserCoverEditor">
                <div>
                    <div class="UserCover">
                        <img src="{{currentUser.background==null?'../img/content/background.jpg':currentUser.background}}"
                             style="width: 1000px">
                    </div>
                </div>
            </div>
            <div class="ProfileHeader-main">
                <!-- 大头像 -->
                <div class="UserAvatarEditor ProfileHeader-avatar">
                    <div class="UserAvatar">
                        <img class="Avatar Avatar--large UserAvatar-inner" width="160" height="160"
                             src="{{currentUser.image==null?'../img/icon/photo.png':currentUser.image}}">
                    </div>
                </div>

                <div class="ProfileHeader-content">
                    <div class="ProfileHeader-contentHead"><h1 class="ProfileHeader-title"><span
                            class="ProfileHeader-name">{{currentUser.name}}</span></h1>
                        <span class="ztext ProfileHeader-headline">{{currentUser.introduction}}</span>
                    </div>
                    <div class="ProfileHeader-contentBody">
                        {{isOwn()?'我':'TA'}}的关注 <span class="Tabs-meta">{{currentUser.follow}}</span>
                        &nbsp;&nbsp;关注{{isOwn()?'我':'TA'}}的 <span
                            class="Tabs-meta">{{currentUser.follower}}</span>
                    </div>
                    <div class="ProfileHeader-contentFooter">
                        <div class="ProfileHeader-buttons" ng-show="user">
                            <a type="button" href="../pages/news_edit.html" class="Button Button--blue"
                               ng-if="isOwn()">发布新闻</a>
                            <a type="button" href="../pages/own_page_edit.html" class="Button Button--blue"
                               ng-if="isOwn()">编辑个人资料</a>
                            <span ng-if="!isOwn()">
                                <a type="button" href="javascript:void(0)"
                                   class="Button Button--blue"
                                   ng-click="follow()" ng-if="!followFlag">关注TA</a>

                                <a type="button" href="javascript:void(0)"
                                   class="Button Button--blue"
                                   ng-click="removeFollow()" ng-if="followFlag">取消关注</a>
                            </span>

                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <div class="Profile-main">
        <div class="Profile-mainColumn" style="width: 100%">
            <div class="Card ProfileMain">
                <!--tab头-->
                <ul class="nav nav-tabs">
                    <li class="active Tabs ProfileMain-tabs">
                        <a href="#news" data-toggle="tab">文章<span class="Tabs-meta">{{newsCount}}</span></a>
                    </li>
                    <li class="Tabs ProfileMain-tabs">
                        <a href="#comment" data-toggle="tab">评论<span class="Tabs-meta">{{commentCount}}</span></a>
                    </li>
                    <li class="Tabs ProfileMain-tabs">
                        <a href="#favorite" data-toggle="tab">收藏<span class="Tabs-meta">{{favoriteCount}}</span></a>
                    </li>
                    <li class="Tabs ProfileMain-tabs" ng-if="isOwn()">
                        <a href="#exception" data-toggle="tab" ng-click="findExceptionNews()">异常处理<span class="Tabs-meta"></span></a>
                    </li>
                </ul>
                <!--tab头/-->

                <!--tab内容-->
                <div class="tab-content">
                    <!--文章-->
                    <div class="tab-pane active" id="news">
                        <div class="List-header"><h4 class="List-headerText"><span>{{isOwn()?'我':'TA'}}的文章</span></h4>
                            <div class="List-headerOptions">
                                <div class="Popover">
                                    <button type="button"
                                            class="Button Select-button Select-plainButton Button--plain">
                                        按时间排序<img src="../img/icon/shangxia.png"
                                                  style="width: 24px;height: 24px">
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="EmptyState" style="margin-top: 75px;padding-bottom: 75px"
                             ng-if="newsList.length<=0">
                            <div class="EmptyState-inner">
                                <img src="../img/icon/blankdoc.png" style="width: 100px;height: 100px">
                                <div>空空如也</div>
                            </div>
                        </div>
                        <div class="List-item" ng-repeat="news in newsList">
                            <!-- 新闻标题 -->
                            <div class="row">
                                <h2 class="ContentItem-title col-sm-10">
                                    <a href="../pages/details.html#?id={{news.id}}" ng-click="">{{news.title}}</a>
                                </h2>
                                <div class="col-sm-1" ng-if="isOwn()">
                                    <a href="javascript:void (0)" ng-click="delete(news.id)">
                                        <img src="../img/icon/delete.png" style="width: 15px;height: 15px"></a>

                                </div>
                                <div class="col-sm-1" ng-if="isOwn()">
                                    <a href="../pages/news_edit.html#?id={{news.id}}"> <img src="../img/icon/update.png"
                                                                                            style="width: 15px;height: 15px"></a>
                                </div>

                            </div>
                            <div class="RichContent is-collapsed">
                                <!-- 文章的图片 -->
                                <div class="RichContent-cover" ng-if="news.image.length>0">
                                    <div class="RichContent-cover-inner">
                                        <img src="{{news.image}}">
                                    </div>
                                </div>
                                <!-- 内容预览 -->
                                <div style="margin-top: 15px" id="content">
                                    <span ng-bind-html="news.content|trustHtml" style='display:-webkit-box;-webkit-box-orient: vertical;
                                        -webkit-line-clamp: 3;overflow:hidden;'>
                                        {{news.content}}</span> ……
                                </div>
                                <!-- 下面的图标-->
                                <div class="ContentItem-actions">
                                    {{news.releaseDate}}
                                    &nbsp;&nbsp;<img src="../img/icon/msg.jpg" style="width: 15px;height: 15px"><span
                                        class="Tabs-meta">{{news.commentCount}}</span>
                                    &nbsp;&nbsp;<img src="../img/icon/yanjing.png"
                                                     style="width: 15px;height: 15px"><span class="Tabs-meta">{{news.visitCount}}</span>
                                    &nbsp;&nbsp;<img src="../img/icon/shoucang.png"
                                                     style="width: 15px;height: 15px"><span class="Tabs-meta">{{news.favoriteCount}}</span>
                                </div>
                            </div>
                        </div>
                        <div style="margin: 20px;margin-left: 400px" ng-if="newsList.length < newsCount">
                            <a class="Button Button--primary" ng-click="findNews()">
                                加载更多……
                            </a>
                        </div>
                    </div>

                    <!--评论-->
                    <div class="tab-pane" id="comment">
                        <div class="List-header"><h4 class="List-headerText"><span>{{isOwn()?'我':'TA'}}的评论</span></h4>
                            <div class="List-headerOptions">
                                <div class="Popover">
                                    <button type="button"
                                            class="Button Select-button Select-plainButton Button--plain">
                                        按时间排序<img src="../img/icon/shangxia.png"
                                                  style="width: 24px;height: 24px">
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="EmptyState" style="margin-top: 100px" ng-if="commentList.length<=0">
                            <div class="EmptyState-inner">
                                <img src="../img/icon/blankdoc.png" style="width: 100px;height: 100px">
                                <div>空空如也</div>
                            </div>
                        </div>
                        <div class="List-item" ng-repeat="entity in commentList">
                            <!-- 新闻标题 -->
                            <h2 class="ContentItem-title">
                                <a href="../pages/details.html#?id={{entity.news.id}}">{{entity.news.title}}</a>
                            </h2>
                            <div class="ContentItem-meta">
                                <div class="AuthorInfo AnswerItem-authorInfo">
                                    <!-- 头像 -->
                                    <a class="UserLink-link" href="https://www.zhihu.com/people/qygg-36">
                                        <img width="38" height="38" style="border-radius: 50%"
                                             src="{{currentUser.image}}">
                                    </a>
                                    <div class="AuthorInfo-content">
                                        <!-- 昵称 -->
                                        <div class="AuthorInfo-head">
                                                    <span class="UserLink AuthorInfo-name">
                                                        <div class="Popover">
                                                            <a class="UserLink-link" href="javascript:void(0)">{{currentUser.name}}</a>
                                                        </div>
                                                    </span>
                                        </div>
                                        <!-- 签名 -->
                                        <div class="AuthorInfo-detail">
                                            <div class="AuthorInfo-badge">
                                                <div class="AuthorInfo-badgeText">
                                                    {{currentUser.introduction}}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="RichContent is-collapsed">
                                <!-- 内容预览 -->
                                <div style="margin-top: 15px">
                                    <span>{{entity.comment.text}}</span>
                                </div>
                                <!-- 下面的图标-->
                                <div class="ContentItem-actions">
                                    {{entity.comment.releaseTime}}
                                    &nbsp;&nbsp;<img src="../img/icon/dianzan.png"
                                                     style="width: 15px;height: 15px"><span class="Tabs-meta">{{entity.comment.likeCount}}</span>
                                </div>
                            </div>
                        </div>
                        <div style="margin: 20px;margin-left: 400px" ng-if="commentList.length < commentCount">
                            <a class="Button Button--primary" ng-click="findComments()">
                                加载更多……
                            </a>
                        </div>
                    </div>

                    <!--收藏-->
                    <div class="tab-pane" id="favorite">
                        <div class="List-header"><h4 class="List-headerText"><span>{{isOwn()?'我':'TA'}}的收藏</span></h4>
                            <div class="List-headerOptions">
                                <div class="Popover">
                                    <button type="button"
                                            class="Button Select-button Select-plainButton Button--plain">
                                        按时间排序<img src="../img/icon/shangxia.png"
                                                  style="width: 24px;height: 24px">
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="EmptyState" style="margin-top: 75px;padding-bottom: 75px"
                             ng-if="favoriteList.length<=0">
                            <div class="EmptyState-inner">
                                <img src="../img/icon/blankdoc.png" style="width: 100px;height: 100px">
                                <div>空空如也</div>
                            </div>
                        </div>
                        <div class="List-item" ng-repeat="news in favoriteList">
                            <!-- 新闻标题 -->
                            <div class="row">
                                <h2 class="ContentItem-title col-sm-10">
                                    <a href="../pages/details.html#?id={{news.id}}" ng-click="">{{news.title}}</a>
                                </h2>
                                <div class="col-sm-offset-1 col-sm-1" ng-if="isOwn()">
                                    <a href="javascript:void (0)" ng-click="removeFavorite(news.id)"> <img src="../img/icon/quxiao.png"
                                                                                            style="width: 15px;height: 15px"></a>
                                </div>

                            </div>
                            <div class="RichContent is-collapsed">
                                <!-- 文章的图片 -->
                                <div class="RichContent-cover" ng-if="news.image.length>0">
                                    <div class="RichContent-cover-inner">
                                        <img src="{{news.image}}">
                                    </div>
                                </div>
                                <!-- 内容预览 -->
                                <div style="margin-top: 15px;height: 130px;overflow:hidden;"  >
                                    <span ng-bind-html="news.content|trustHtml" >
                                        {{news.content}}</span> ……
                                </div>
                                <!-- 下面的图标-->
                                <div class="ContentItem-actions">
                                    {{news.releaseDate}}
                                    &nbsp;&nbsp;<img src="../img/icon/msg.jpg" style="width: 15px;height: 15px"><span
                                        class="Tabs-meta">{{news.commentCount}}</span>
                                    &nbsp;&nbsp;<img src="../img/icon/yanjing.png"
                                                     style="width: 15px;height: 15px"><span class="Tabs-meta">{{news.visitCount}}</span>
                                    &nbsp;&nbsp;<img src="../img/icon/shoucang.png"
                                                     style="width: 15px;height: 15px"><span class="Tabs-meta">{{news.favoriteCount}}</span>
                                </div>
                            </div>
                        </div>
                        <div style="margin: 20px;margin-left: 400px" ng-if="favoriteList.length < favoriteListCount">
                            <a class="Button Button--primary" ng-click="findFavoriteNews()">
                                加载更多……
                            </a>
                        </div>
                    </div>

                    <!--异常-->
                    <div class="tab-pane" id="exception">
                        <div class="List-header">
                            <h4 class="List-headerText"><span>异常文章</span></h4>
                            <div class="List-headerOptions">
                                状态：
                                <select ng-options="item.status as item.text for item in statusArr"
                                        ng-model="status">
                                    {{item.text}}
                                </select>

                            </div>
                        </div>
                        <div class="List-item" ng-repeat="news in exceptionNewsList">
                            <!-- 新闻标题 -->
                            <div class="row">
                                <h2 class="ContentItem-title col-sm-9">
                                    <a href="../pages/details.html#?id={{news.id}}" ng-click="">{{news.title}}</a>
                                </h2>
                                <div class="col-sm-1">
                                    <a href="javascript:void (0)" ng-click="delete(news.id)">
                                        <img src="../img/icon/delete.png" style="width: 15px;height: 15px">
                                    </a>

                                </div>
                                <div class="col-sm-1" ng-if="news.status!=4">
                                    <a href="../pages/news_edit.html#?id={{news.id}}"> <img src="../img/icon/update.png"
                                                                                            style="width: 15px;height: 15px"></a>
                                </div>
                                <div class="col-sm-1">
                                    <a href="javascript:void (0)" data-toggle="modal"  data-target="#editModal" ng-click="examine={};examineNews(news.id)"> <img src="../img/icon/warning.png"
                                                                                            style="width: 15px;height: 15px"></a>
                                </div>

                            </div>
                            <div class="RichContent is-collapsed">
                                <!-- 文章的图片 -->
                                <div class="RichContent-cover" ng-if="news.image.length>0">
                                    <div class="RichContent-cover-inner">
                                        <img src="{{news.image}}">
                                    </div>
                                </div>
                                <!-- 内容预览 -->
                                <div style="margin-top: 15px;height: 130px;overflow:hidden;" >
                                    <span ng-bind-html="news.content|trustHtml">
                                        {{news.content}}</span> ……
                                </div>
                                <!-- 下面的图标-->
                                <div class="ContentItem-actions">
                                    {{news.releaseDate}}
                                    &nbsp;&nbsp;<img src="../img/icon/msg.jpg" style="width: 15px;height: 15px"><span
                                        class="Tabs-meta">{{news.commentCount}}</span>
                                    &nbsp;&nbsp;<img src="../img/icon/yanjing.png"
                                                     style="width: 15px;height: 15px"><span class="Tabs-meta">{{news.visitCount}}</span>
                                    &nbsp;&nbsp;<img src="../img/icon/shoucang.png"
                                                     style="width: 15px;height: 15px"><span class="Tabs-meta">{{news.favoriteCount}}</span>
                                </div>
                            </div>
                        </div>
                        <div class="EmptyState" style="margin-top: 75px;padding-bottom: 75px"
                             ng-if="exceptionNewsList.length<=0">
                            <div class="EmptyState-inner">
                                <img src="../img/icon/blankdoc.png" style="width: 100px;height: 100px">
                                <div>空空如也</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>
<!--审核详情窗口-->
<div class="modal fade" id="editModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog" style="width: 75%;margin-top: -100px">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h3 id="myModalLabel">新闻审核</h3>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-6 col-xs-10" style="border-right: 1px solid lightgrey">
                        <strong>详情</strong>
                        <hr>
                        <table class="table table-bordered table-striped">
                            <tr>
                                <th class="sorting_asc">ID</th>
                                <th class="sorting_desc">新闻标题</th>
                                <th class="sorting_desc">状态</th>
                            </tr>
                            <tr>
                                <td>{{news.id}}</td>
                                <td>
                                    {{news.title}}
                                </td>
                                <td>{{tipArr[news.status]}}</td>
                            </tr>
                        </table>
                        <hr>
                        <strong>审核记录</strong>
                        <hr>
                        <div ng-if="examineList.length<=0">暂无记录</div>
                        <div style="width:100%;height: 145px;overflow: scroll">
                            <div ng-repeat="entity in examineList" ng-if="examineList.length>0">
                                {{entity.operation}}:{{entity.content}}
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6 col-xs-10" ng-if="news.status!=4">
                        <strong>申请理由</strong>
                        <hr>
                        <textarea ng-model="examine.content" style="width: 100%;height: 100%;" rows="16" placeholder="请输入您申请审核的理由"></textarea>
                    </div>
                </div>

            </div>
            <div class="modal-footer" style="text-align: center">
                <a href="javascript:void (0)" class="btn btn-success" data-dismiss="modal" aria-hidden="true" ng-click="updateStatus()" ng-if="news.status!=4">提交审核</a>
                <button class="btn btn-default" data-dismiss="modal" aria-hidden="true">关闭</button>
            </div>
        </div>
    </div>
</div>
</body>
</html>